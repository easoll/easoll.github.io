<!DOCTYPE html>



  


<html class="theme-next mist use-motion" lang="zh-Hans">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>
<meta name="theme-color" content="#222">









<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />
















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />







<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.1.2" rel="stylesheet" type="text/css" />


  <meta name="keywords" content="Hexo, NexT" />








  <link rel="shortcut icon" type="image/x-icon" href="/favicon.ico?v=5.1.2" />






<meta property="og:type" content="website">
<meta property="og:title" content="Easoll">
<meta property="og:url" content="http://www.mrhere.cn/index.html">
<meta property="og:site_name" content="Easoll">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Easoll">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Mist',
    version: '5.1.2',
    sidebar: {"position":"left","display":"post","offset":12,"offset_float":12,"b2t":false,"scrollpercent":false,"onmobile":false},
    fancybox: true,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn"}},
    duoshuo: {
      userId: '0',
      author: '博主'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="http://www.mrhere.cn/"/>





  <title>Easoll</title>
  








</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  
  
    
  

  <div class="container sidebar-position-left 
  page-home">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/"  class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">Easoll</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle"></p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br />
            
            标签
          </a>
        </li>
      
        
        <li class="menu-item menu-item-categories">
          <a href="/categories/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-th"></i> <br />
            
            分类
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />
            
            归档
          </a>
        </li>
      

      
    </ul>
  

  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            
  <section id="posts" class="posts-expand">
    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://www.mrhere.cn/2018/06/23/记一次安卓Handler-removeMessages引发的问题/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Easoll">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/06/23/记一次安卓Handler-removeMessages引发的问题/" itemprop="url">记一次安卓Handler.removeMessages引发的问题</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-06-23T10:32:03+08:00">
                2018-06-23
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div></pre></td><td class="code"><pre><div class="line">public class MainActivity extends AppCompatActivity &#123;</div><div class="line">    private static final String TAG = &quot;MainActivity&quot;;</div><div class="line"></div><div class="line">    private static final int MESSAGE_WHAT_SAY_HI = 0;</div><div class="line">    private static final int MESSAGE_WHAT_SAY_HELLO = 1;</div><div class="line"></div><div class="line">    private static class MyHandler extends Handler&#123;</div><div class="line">        @Override</div><div class="line">        public void handleMessage(Message msg) &#123;</div><div class="line">            switch (msg.what)&#123;</div><div class="line">                case MESSAGE_WHAT_SAY_HI:</div><div class="line">                    Log.i(TAG, &quot;hi&quot;);</div><div class="line">                    break;</div><div class="line">                case MESSAGE_WHAT_SAY_HELLO:</div><div class="line">                    Log.i(TAG, &quot;hello&quot;);</div><div class="line">                    break;</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    @Override</div><div class="line">    protected void onCreate(Bundle savedInstanceState) &#123;</div><div class="line">        super.onCreate(savedInstanceState);</div><div class="line">        setContentView(R.layout.activity_main);</div><div class="line"></div><div class="line">        Handler handler = new MyHandler();</div><div class="line">        long delayTime = 5000;</div><div class="line"></div><div class="line">        handler.postDelayed(new Runnable() &#123;</div><div class="line">            @Override</div><div class="line">            public void run() &#123;</div><div class="line">                Log.i(TAG, &quot;en....&quot;);</div><div class="line">            &#125;</div><div class="line">        &#125;, delayTime);</div><div class="line"></div><div class="line">        handler.sendEmptyMessageDelayed(MESSAGE_WHAT_SAY_HI, delayTime);</div><div class="line"></div><div class="line">        handler.sendEmptyMessageDelayed(MESSAGE_WHAT_SAY_HELLO, delayTime);</div><div class="line"></div><div class="line">        handler.removeMessages(MESSAGE_WHAT_SAY_HI);</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>以上代码输入为：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">hello</div></pre></td></tr></table></figure></p>
<p>而不是：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">en....</div><div class="line">hello</div></pre></td></tr></table></figure></p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://www.mrhere.cn/2018/06/23/安卓7-0动态链接库加载流程/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Easoll">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/06/23/安卓7-0动态链接库加载流程/" itemprop="url">安卓7.0动态链接库加载流程</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-06-23T10:08:20+08:00">
                2018-06-23
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p><a href="http://androidxref.com/7.0.0_r1/xref/libcore/ojluni/src/main/native/Runtime.c" target="_blank" rel="external">Runtime.c</a><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">Runtime_nativeLoad()</div></pre></td></tr></table></figure></p>
<p><a href="http://androidxref.com/7.0.0_r1/xref/art/runtime/openjdkjvm/OpenjdkJvm.cc" target="_blank" rel="external">OpenjdkJvm.cc</a><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">JVM_NativeLoad()</div></pre></td></tr></table></figure></p>
<p><a href="http://androidxref.com/7.0.0_r1/xref/art/runtime/java_vm_ext.cc" target="_blank" rel="external">java_vm_ext.cc</a><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">LoadNativeLibrary()</div></pre></td></tr></table></figure></p>
<p><a href="http://androidxref.com/7.0.0_r1/xref/system/core/libnativeloader/native_loader.cpp" target="_blank" rel="external">native_loader.cpp</a><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">OpenNativeLibrary()</div></pre></td></tr></table></figure></p>
<p><a href="http://androidxref.com/7.0.0_r1/xref/bionic/linker/dlfcn.cpp" target="_blank" rel="external">dlfcn.cpp</a><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">dlopen()</div><div class="line">dlopen_ext()</div></pre></td></tr></table></figure></p>
<p><a href="http://androidxref.com/7.0.0_r1/xref/bionic/linker/linker.cpp" target="_blank" rel="external">linker.cpp</a><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line">do_dlopen()</div><div class="line">find_library()</div><div class="line">find_libraries()</div><div class="line">find_library_internal</div><div class="line">load_library(android_namespace_t* ns,</div><div class="line">                       LoadTask* task,</div><div class="line">                       ZipArchiveCache* zip_archive_cache,</div><div class="line">                       LoadTaskList* load_tasks,</div><div class="line">                       int rtld_flags)</div><div class="line"></div><div class="line">load_library(android_namespace_t* ns,</div><div class="line">                        LoadTask* task,</div><div class="line">                        LoadTaskList* load_tasks,</div><div class="line">                        int rtld_flags,</div><div class="line">                        const std::string&amp; realpath)</div><div class="line"></div><div class="line">LoadTask-&gt;read()</div></pre></td></tr></table></figure></p>
<p><a href="http://androidxref.com/7.0.0_r1/xref/bionic/linker/linker_phdr.cpp" target="_blank" rel="external">linker_phdr.cpp</a><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">ElfReader-&gt;Read()</div></pre></td></tr></table></figure></p>
<p>参考：<a href="http://wps2015.org/drops/drops/Android%20Linker%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0.html" target="_blank" rel="external">http://wps2015.org/drops/drops/Android%20Linker%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0.html</a></p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://www.mrhere.cn/2018/05/19/提升进程优先级的一种新姿势/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Easoll">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/05/19/提升进程优先级的一种新姿势/" itemprop="url">提升进程优先级的一种新姿势</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-05-19T10:05:04+08:00">
                2018-05-19
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>在安卓中调用Service的startForeground方法可以将service所在进程的优先级提高，减小进程被回收的概率。<br>调用startForeground方法的时候系统会在通知栏显示一个通知，这对于传统的多媒体应用来说是没有问题的。<br>但是对于那些只想提升优先级而不想让用户感知的应用来说强行显示个通知栏看起来太怪异了。</p>
<p>查看startForeground的源码之后，发现有很重要的两步，如下所示：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line">ActiveServices.java</div><div class="line"></div><div class="line">private void setServiceForegroundInnerLocked(ServiceRecord r, int id,</div><div class="line">            Notification notification, int flags) &#123;</div><div class="line">        if (id != 0) &#123;</div><div class="line">            ......</div><div class="line">            r.postNotification();  //step1: 在通知栏显示通知</div><div class="line">            if (r.app != null) &#123;</div><div class="line">                updateServiceForegroundLocked(r.app, true);  //step2: 更新进程优先级</div><div class="line">            &#125;</div><div class="line">            getServiceMapLocked(r.userId).ensureNotStartingBackgroundLocked(r);</div><div class="line">            mAm.notifyPackageUse(r.serviceInfo.packageName,</div><div class="line">                                 PackageManager.NOTIFY_PACKAGE_USE_FOREGROUND_SERVICE);</div><div class="line">        &#125; else &#123;</div><div class="line">            ......</div><div class="line">        &#125;</div><div class="line">    &#125;</div></pre></td></tr></table></figure></p>
<p>那么我们有没有办法能让updateServiceForegroundLocked执行成功，而让postNotification()执行失败呢？<br>进一步查看postNotification()方法：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div></pre></td><td class="code"><pre><div class="line">ServiceRecord.java</div><div class="line"></div><div class="line">public void postNotification() &#123;</div><div class="line"></div><div class="line">        if (foregroundId != 0 &amp;&amp; foregroundNoti != null) &#123;</div><div class="line">            // Do asynchronous communication with notification manager to</div><div class="line">            // avoid deadlocks.</div><div class="line">            final String localPackageName = packageName;</div><div class="line">            final int localForegroundId = foregroundId;</div><div class="line">            final Notification _foregroundNoti = foregroundNoti;</div><div class="line">            ams.mHandler.post(new Runnable() &#123;</div><div class="line">                public void run() &#123;</div><div class="line">                    NotificationManagerInternal nm = LocalServices.getService(</div><div class="line">                            NotificationManagerInternal.class);</div><div class="line">                    if (nm == null) &#123;</div><div class="line">                        return;</div><div class="line">                    &#125;</div><div class="line">                    Notification localForegroundNoti = _foregroundNoti;</div><div class="line">                    try &#123;</div><div class="line">                        ......</div><div class="line">                        //step1: 向NotificationManagerServervice发送通知</div><div class="line">                        nm.enqueueNotification(localPackageName, localPackageName,</div><div class="line">                                appUid, appPid, null, localForegroundId, localForegroundNoti,</div><div class="line">                                userId);</div><div class="line"></div><div class="line">                    &#125; catch (RuntimeException e) &#123;</div><div class="line">                        Slog.w(TAG, &quot;Error showing notification for service&quot;, e);</div><div class="line">                        // If it gave us a garbage notification, it doesn&apos;t</div><div class="line">                        // get to be foreground.</div><div class="line">                        ams.setServiceForeground(name, ServiceRecord.this,</div><div class="line">                                0, null, 0);</div><div class="line">                        //step2:如果出现异常，则将应用进程crash掉</div><div class="line">                        ams.crashApplication(appUid, appPid, localPackageName, -1,</div><div class="line">                                &quot;Bad notification for startForeground: &quot; + e);</div><div class="line">                    &#125;</div><div class="line">                &#125;</div><div class="line">            &#125;);</div><div class="line">        &#125;</div><div class="line">    &#125;</div></pre></td></tr></table></figure></p>
<p>由上可知，只要enqueueNotification执行出现异常，通知栏则不会显示通知了，但是此时却会导致应用进程crash调用。<br>那么如何使得crashApplication这个方法失效呢，我们进一步查看crashApplication方法的代码：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div></pre></td><td class="code"><pre><div class="line">ActivityManagerService.java</div><div class="line"></div><div class="line">public void crashApplication(int uid, int initialPid, String packageName, int userId,</div><div class="line">        String message) &#123;</div><div class="line">    if (checkCallingPermission(android.Manifest.permission.FORCE_STOP_PACKAGES)</div><div class="line">            != PackageManager.PERMISSION_GRANTED) &#123;</div><div class="line">        String msg = &quot;Permission Denial: crashApplication() from pid=&quot;</div><div class="line">                + Binder.getCallingPid()</div><div class="line">                + &quot;, uid=&quot; + Binder.getCallingUid()</div><div class="line">                + &quot; requires &quot; + android.Manifest.permission.FORCE_STOP_PACKAGES;</div><div class="line">        Slog.w(TAG, msg);</div><div class="line">        throw new SecurityException(msg);</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    synchronized(this) &#123;</div><div class="line">        //最终会通过binder，调用应用进程中的scheduleCrash方法</div><div class="line">        mAppErrors.scheduleAppCrashLocked(uid, initialPid, packageName, userId, message);</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
 <figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div></pre></td><td class="code"><pre><div class="line">ActivityThread.java</div><div class="line"></div><div class="line"> private class ApplicationThread extends IApplicationThread.Stub &#123;</div><div class="line">    public void scheduleCrash(String msg) &#123;</div><div class="line">         //通过handler发送一个类型为H.SCHEDULE_CRASH的消息</div><div class="line">         sendMessage(H.SCHEDULE_CRASH, msg);</div><div class="line">    &#125;</div><div class="line"> &#125;</div><div class="line"></div><div class="line"> private class H extends Handler &#123;</div><div class="line">   public void handleMessage(Message msg) &#123;</div><div class="line">       if (DEBUG_MESSAGES) Slog.v(TAG, &quot;&gt;&gt;&gt; handling: &quot; + codeToString(msg.what));</div><div class="line">       switch (msg.what) &#123;</div><div class="line">           ......</div><div class="line">           case SCHEDULE_CRASH:</div><div class="line">               //当收到类型为SCHEDULE_CRASH的消息的时候则抛出一个异常，导致进程crash</div><div class="line">               throw new RemoteServiceException((String)msg.obj);</div><div class="line">           ......</div><div class="line">       &#125;</div><div class="line"> &#125;</div></pre></td></tr></table></figure>
<p>我们现在已经知道了ams是如何让我们的进程crash的了，基本就是ams跟我们应用进程说，你准备准备该去死了，然后应用进程就去死了。<br>但是做为一个有个性的进程，能不能在ams让他去死的时候假装没听见呢？显然是可以的，基本的流程就是：</p>
<ol>
<li>先拿到ActivityThread的实例</li>
<li>拿到ActivityThread$H 的实例mH</li>
<li>向mH设置一个Handler.Callback</li>
<li>在Handler.Callback 中检测到 SCHEDULE_CRASH消息时则消费该消息</li>
</ol>
<p>具体实现代码如下所示：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div></pre></td><td class="code"><pre><div class="line">private static void hookH()&#123;</div><div class="line">        if(mHasHookH)&#123;</div><div class="line">            return;</div><div class="line">        &#125;</div><div class="line"></div><div class="line">        mHasHookH = true;</div><div class="line"></div><div class="line">        try &#123;</div><div class="line">            try &#123;</div><div class="line">                Class hClass = Class.forName(&quot;android.app.ActivityThread$H&quot;);</div><div class="line">                Field scheduleCrashField = hClass.getDeclaredField(&quot;SCHEDULE_CRASH&quot;);</div><div class="line">                mScheduleCrashMsgWhat = (int)scheduleCrashField.get(null);</div><div class="line">                Log.i(TAG, &quot;get mScheduleCrashMsgWhat success&quot;);</div><div class="line">            &#125;catch (Exception e)&#123;</div><div class="line">                Log.i(TAG, &quot;get mScheduleCrashMsgWhat failed&quot;);</div><div class="line"></div><div class="line">                e.printStackTrace();</div><div class="line">            &#125;</div><div class="line"></div><div class="line">            Handler.Callback callback = new Handler.Callback() &#123;</div><div class="line">                @Override</div><div class="line">                public boolean handleMessage(Message msg) &#123;</div><div class="line">                    Log.i(TAG, msg.toString());</div><div class="line"></div><div class="line">                    if(msg.what == mScheduleCrashMsgWhat)&#123;</div><div class="line">                        return true;</div><div class="line">                    &#125;</div><div class="line"></div><div class="line">                    return false;</div><div class="line">                &#125;</div><div class="line">            &#125;;</div><div class="line"></div><div class="line">            Class activityThreadClass = Class.forName(&quot;android.app.ActivityThread&quot;);</div><div class="line">            Field mH = activityThreadClass.getDeclaredField(&quot;mH&quot;);</div><div class="line">            mH.setAccessible(true);</div><div class="line">            Method currentActivityThread = activityThreadClass.getDeclaredMethod(&quot;currentActivityThread&quot;);</div><div class="line">            Object activityThreadInstance = currentActivityThread.invoke(null);</div><div class="line">            Handler hInstance = (Handler) mH.get(activityThreadInstance);</div><div class="line">            Class handlerClass = Handler.class;</div><div class="line">            Field mCallbackField = handlerClass.getDeclaredField(&quot;mCallback&quot;);</div><div class="line">            mCallbackField.setAccessible(true);</div><div class="line">            mCallbackField.set(hInstance, callback);</div><div class="line">        &#125;catch (Exception e)&#123;</div><div class="line">            e.printStackTrace();</div><div class="line">        &#125;</div><div class="line">    &#125;</div></pre></td></tr></table></figure></p>
<p>这里写了一个工具类方便大家使用：<a href="https://github.com/easoll/RaisePriorityHack" target="_blank" rel="external">RaisePriorityHack</a></p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://www.mrhere.cn/2017/11/04/Media-insert插入的图片文件大小比原图小/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Easoll">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2017/11/04/Media-insert插入的图片文件大小比原图小/" itemprop="url">Media.insert插入的图片文件大小比原图小</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-11-04T16:09:35+08:00">
                2017-11-04
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/android/" itemprop="url" rel="index">
                    <span itemprop="name">android</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line">public static final String insertImage(ContentResolver cr, Bitmap source,</div><div class="line">                                                   String title, String description) &#123;</div><div class="line">    ContentValues values = new ContentValues();</div><div class="line">    values.put(Images.Media.TITLE, title);</div><div class="line">    values.put(Images.Media.DESCRIPTION, description);</div><div class="line">    values.put(Images.Media.MIME_TYPE, &quot;image/jpeg&quot;);</div><div class="line"></div><div class="line"></div><div class="line">    url = cr.insert(EXTERNAL_CONTENT_URI, values);</div><div class="line"></div><div class="line">    OutputStream imageOut = cr.openOutputStream(url);</div><div class="line"></div><div class="line">    source.compress(Bitmap.CompressFormat.JPEG, 50, imageOut);</div><div class="line"></div><div class="line">&#125;</div></pre></td></tr></table></figure>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://www.mrhere.cn/2017/11/04/okhttp中interceptors和networkInterceptors的区别/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Easoll">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2017/11/04/okhttp中interceptors和networkInterceptors的区别/" itemprop="url">okhttp中interceptors和networkInterceptors的区别</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-11-04T15:24:10+08:00">
                2017-11-04
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>在学习okhttp时发现在OkHttpClient内部有两个用来存储interceptor的链表，分别是interceptors和networkInterceptors,那么这两个列表中存储的interceptor有什么区别呢？<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">public class OkHttpClien&#123;</div><div class="line">	final List&lt;Interceptor&gt; interceptors;</div><div class="line">	final List&lt;Interceptor&gt; networkInterceptors;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>要想弄清楚这个问题，我们首先要知道Interceptor是什么并且okhttp的网络请求处理流程是怎样的。</p>
<h1 id="Interceptor简介"><a href="#Interceptor简介" class="headerlink" title="Interceptor简介"></a>Interceptor简介</h1><p>Interceptor是一个接口,类图如下所示<br><img src="/images/okhttp.png" alt="标准模板"></p>
<p>java 文档中对其的介绍是：</p>
<blockquote>
<p>Observes, modifies, and potentially short-circuits requests going out and the corresponding responses coming back in. Typically interceptors add, remove, or transform headers on the request or response.</p>
</blockquote>
<p>就是说Interceptor观察，修改并且可能短路发送的请求和相应的服务端返回的内容。一些特殊的Interceptor会添加，删除或者转换网络请求和响应的头部。</p>
<h1 id="okhttp网络请求处理流程"><a href="#okhttp网络请求处理流程" class="headerlink" title="okhttp网络请求处理流程"></a>okhttp网络请求处理流程</h1><p>okhttp网络请求的核心代码如下所示<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div></pre></td><td class="code"><pre><div class="line">final class RealCall implements Call &#123;</div><div class="line">	Response getResponseWithInterceptorChain() throws IOException &#123;</div><div class="line">    // Build a full stack of interceptors.</div><div class="line">    List&lt;Interceptor&gt; interceptors = new ArrayList&lt;&gt;();</div><div class="line">    interceptors.addAll(client.interceptors());</div><div class="line">    interceptors.add(retryAndFollowUpInterceptor);</div><div class="line">    interceptors.add(new BridgeInterceptor(client.cookieJar()));</div><div class="line">    interceptors.add(new CacheInterceptor(client.internalCache()));</div><div class="line">    interceptors.add(new ConnectInterceptor(client));</div><div class="line">    if (!forWebSocket) &#123;</div><div class="line">      interceptors.addAll(client.networkInterceptors());</div><div class="line">    &#125;</div><div class="line">    interceptors.add(new CallServerInterceptor(forWebSocket));</div><div class="line"></div><div class="line">    Interceptor.Chain chain = new RealInterceptorChain(interceptors, null, null, null, 0,</div><div class="line">        originalRequest, this, eventListener, client.connectTimeoutMillis(),</div><div class="line">        client.readTimeoutMillis(), client.writeTimeoutMillis());</div><div class="line"></div><div class="line">    return chain.proceed(originalRequest);</div><div class="line">  &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line">public final class RealInterceptorChain implements Interceptor.Chain &#123;</div><div class="line">	private final List&lt;Interceptor&gt; interceptors;</div><div class="line">	private final int index;</div><div class="line"></div><div class="line">	public Response proceed(Request request, StreamAllocation</div><div class="line"></div><div class="line">    // Call the next interceptor in the chain.</div><div class="line">    RealInterceptorChain next = new RealInterceptorChain(interceptors, streamAllocation, httpCodec,</div><div class="line">        connection, index + 1, request, call, eventListener, connectTimeout, readTimeout,</div><div class="line">        writeTimeout);</div><div class="line">    Interceptor interceptor = interceptors.get(index);</div><div class="line">    Response response = interceptor.intercept(next);</div><div class="line"></div><div class="line"></div><div class="line">    return response;</div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>我们看到，最后调用了RealInterceptorChain的procced方法来处理我们的请求。RealInterceptorChain类内部维护了一个index，用来记录传进来的request应该由哪个Interceptor来处理。在Interceptor的intercept方法中只要通过调用chain.process就可将请求传递给下一个Interceptor来处理。这种模式是一个典型的责任链模式。</p>
<h1 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h1><p>由于interceptors和networkInterces在责任链中的位置不同，他们能做的事情也就不同了。比如，如果我们要对服务端返回的数据做自定义缓存就应该在interceptors中处理，而如果我们想控制网络请求的创建连接等就应该在networkInterceptor中处理了</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://www.mrhere.cn/2017/11/04/安卓踩坑记录/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Easoll">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2017/11/04/安卓踩坑记录/" itemprop="url">安卓踩坑记录</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-11-04T13:11:44+08:00">
                2017-11-04
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/android/" itemprop="url" rel="index">
                    <span itemprop="name">android</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="windows下运行adb-device无法查看到自己的设备"><a href="#windows下运行adb-device无法查看到自己的设备" class="headerlink" title="windows下运行adb device无法查看到自己的设备"></a>windows下运行adb device无法查看到自己的设备</h1><ol>
<li><p>手机未开启开发者模式, 如何开启可参考:<a href="https://developer.android.com/studio/debug/dev-options.html" target="_blank" rel="external">https://developer.android.com/studio/debug/dev-options.html</a></p>
</li>
<li><p>电脑未安装google USB驱动， 具体如何安装可参考:<a href="https://developer.android.com/studio/run/win-usb.html?hl=zh-cn" target="_blank" rel="external">https://developer.android.com/studio/run/win-usb.html?hl=zh-cn</a></p>
</li>
</ol>
<h1 id="常见开发错误"><a href="#常见开发错误" class="headerlink" title="常见开发错误"></a>常见开发错误</h1><ol>
<li>写布局文件时错把View写成view(注意首字母大写),导致layoutinflater找不到相应的类</li>
<li>新建activity，service后忘记在<a href="https://developer.android.com/guide/topics/manifest/manifest-intro.html" target="_blank" rel="external">manifest</a>文件中添加相应的声明，导致组件无法启动.</li>
<li>开发<a href="https://developer.android.com/guide/components/fragments.html" target="_blank" rel="external">fragment</a>时，使用了系统的fragment和<a href="https://developer.android.com/topic/libraries/support-library/index.html" target="_blank" rel="external">support包</a>中的fragment manage</li>
<li>使用LinearLayout时忘记设置orientation属性</li>
<li>webview中的图片有时能加载有时不能加载，可能是因为你对WebSettings设置了setBlockNetworkImage</li>
</ol>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://www.mrhere.cn/2017/11/04/安卓源码在线查看/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Easoll">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2017/11/04/安卓源码在线查看/" itemprop="url">安卓源码在线查看</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-11-04T12:45:04+08:00">
                2017-11-04
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/android/" itemprop="url" rel="index">
                    <span itemprop="name">android</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>关于如何下载安卓源码网上有一大堆的教程，但是鉴于国内的情况，想要正常下好一个版本的安卓源码可以说是长路漫漫了。这里推荐一个安卓源码在线查看网站，该网站可查看所有版本安卓的源码，还可查找引用。实在是安卓开发人员必备<br><a href="http://androidxref.com/" target="_blank" rel="external">http://androidxref.com/</a></p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://www.mrhere.cn/2017/10/25/gradle常用命令/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Easoll">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2017/10/25/gradle常用命令/" itemprop="url">gradle常用命令</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-10-25T19:03:16+08:00">
                2017-10-25
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/gradle/" itemprop="url" rel="index">
                    <span itemprop="name">gradle</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="查看包含的项目"><a href="#查看包含的项目" class="headerlink" title="查看包含的项目"></a>查看包含的项目</h1><p>gradle projects</p>
<h1 id="查看项目包含哪些task"><a href="#查看项目包含哪些task" class="headerlink" title="查看项目包含哪些task"></a>查看项目包含哪些task</h1><p>gralde 项目路径:tasks</p>
<h1 id="查看项目依赖"><a href="#查看项目依赖" class="headerlink" title="查看项目依赖"></a>查看项目依赖</h1><p>gradle 项目路径:dependencies</p>
<h1 id="查看安卓依赖"><a href="#查看安卓依赖" class="headerlink" title="查看安卓依赖"></a>查看安卓依赖</h1><p>gradle 项目路径:androidDepenedncies</p>
<h1 id="查看详细输出"><a href="#查看详细输出" class="headerlink" title="查看详细输出"></a>查看详细输出</h1><p>使用 –debug 选项，该选项可以输出详细信息，比如下载外部依赖失败时可以加上该参数来查看具体是哪个依赖无法下载</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://www.mrhere.cn/2017/10/19/python中repr与str的区别/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Easoll">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2017/10/19/python中repr与str的区别/" itemprop="url">python中repr与str的区别</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-10-19T20:07:05+08:00">
                2017-10-19
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="python-内建函数-str-和-repr-的区别"><a href="#python-内建函数-str-和-repr-的区别" class="headerlink" title="python 内建函数 str() 和 repr() 的区别"></a>python 内建函数 str() 和 repr() 的区别</h1><ol>
<li>内建函数str()和repr() 或反引号操作符（``）可以方便地以字符串的方式获取对象的内容、类型、数值属性等信息。</li>
<li>str()函数得到的字符串可读性好（故被print调用）</li>
<li>repr()函数得到的字符串通常可以用来重新获得该对象，通常情况下 obj==eval(repr(obj)) 这个等式是成立的。这两个函数接受一个对象作为其参数，返回适当的字符串。</li>
<li>事实上repr()和``做一样的事情，返回一个对象的“官方”字符串表示。其结果绝大多数情况下（不是所有）可以通过求值运算（内建函数eval()）重新得到该对象。str()则不同，它生成一个对象的可读性好的字符串表示，结果通常无法用eval()求值，但适合print输出。</li>
</ol>
<h1 id="实例："><a href="#实例：" class="headerlink" title="实例："></a>实例：</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">a = &apos;Hello, world.&apos;</div><div class="line">b = str(a)</div><div class="line">c = eval(repr(a))</div><div class="line">print a==b</div><div class="line">print a==c</div><div class="line">print str(a)   #对用户友好</div><div class="line">print repr(a)  # 对python友好</div></pre></td></tr></table></figure>
<p>结果如下：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">True</div><div class="line">False</div><div class="line">True</div><div class="line">Hello, world.  </div><div class="line">&apos;Hello, world.&apos;</div></pre></td></tr></table></figure></p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://www.mrhere.cn/2017/10/10/主流开源协议简介及对比/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Easoll">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2017/10/10/主流开源协议简介及对比/" itemprop="url">主流开源协议简介及对比</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-10-10T21:57:41+08:00">
                2017-10-10
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/杂谈/" itemprop="url" rel="index">
                    <span itemprop="name">杂谈</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="开源协议简介"><a href="#开源协议简介" class="headerlink" title="开源协议简介"></a>开源协议简介</h1><p>常见的开源许可协议有：GPL、LGPL、BSD、Apache Licence vesion 2.0、MIT。这些协议有什么区别呢？</p>
<h2 id="GPL"><a href="#GPL" class="headerlink" title="GPL"></a><a href="http://www.gnu.org/licenses/gpl.html" target="_blank" rel="external">GPL</a></h2><p>GPL全称 GNU General Public License。它的主要内容为：只要在一个软件中使用(“使用”指类库引用或者修改后的代码) GPL 协议的产品，则该软件产品必须也采用GPL协议，既必须也是开源和免费。这个协议就不太适合商用软件，或者准备使用GPL开源组件的商用项目。基于这个协议的项目，极大的提高了开源软件的数量。上面那个微博的案例，如果作者使用了GPL协议，而使用方所写代码的软件包再发布时没有公开源代码就是违反了协议(多谢Sunny2038纠正)。目前用的多的是GPLV1，GPLV2。这两个什么区别看后面那张树形图。采用这个协议的开源软件有：Linux、 MySQL。</p>
<h2 id="LGPL"><a href="#LGPL" class="headerlink" title="LGPL"></a><a href="http://www.gnu.org/copyleft/lesser.html" target="_blank" rel="external">LGPL</a></h2><p>LGPL，最初是Library GPL的缩写，后来改称作Lesser GPL。由于GPL太严格，限制了很多商用软件使用GPL组件才推出了这个LGPL。LGPL允许商业软件通过引用类库的方式使用LGPL组件（不直接使用源代码），这样可以不需要开源商业软件的代码。但是如果要修改原始组件的代码，则涉及修改部分的代码和基于原来代码衍生的代码都必须采用LGPL协议。LGPL不适合以LGPL协议为基础的代码进行二次开发的商业软件，但是商用软件可以采用编译后的类库引用就不需要公开源代码了。采用这个协议的开源软件有： JBoss、 FCKeditor 、 Hibernate。之前extjs就因为从LGPL转换到GPL带来了不少的震动。</p>
<h2 id="BSD"><a href="#BSD" class="headerlink" title="BSD"></a><a href="http://en.wikipedia.org/wiki/BSD_licenses" target="_blank" rel="external">BSD</a></h2><p>BSD，全称 Berkeley Software Distribution。这个协议相对上面两个协议宽松很多，允许使用者修改和重新发布代码，也允许使用或在BSD代码基础上开发商业软件发布和销售，因此是适用于商业软件的。使用者别太高兴，使用时还必须做到满足三个条件：<br>1）如果再发布的产品中包含源代码，则在源代码中必须带有原来代码中的BSD协议。<br>2）如果再发布的只是二进制类库/软件，则需要在类库/软件的文档和版权声明中包含原来代码中的BSD协议。<br>3）不可以用开源代码的作者/机构名字和原来产品的名字做市场推广。适用BSD协议的开源软件有： nginx、CruiseControl、Redis。</p>
<h2 id="Apache-Licence-vesion-2-0"><a href="#Apache-Licence-vesion-2-0" class="headerlink" title="Apache Licence vesion 2.0"></a><a href="http://www.apache.org/licenses/LICENSE-2.0" target="_blank" rel="external">Apache Licence vesion 2.0</a></h2><p>这个协议除了为用户提供版权许可之外，还有专利许可。与BSD协议权限类似， 允许代码修改，再发布，适用商业软件。但是也需要满足以下条件：</p>
<ol>
<li>需要给代码的用户一份Apache Licence。    </li>
<li>如果你修改了代码，需要再被修改的文件中说明。    </li>
<li>在延伸的代码中（修改和有源代码衍生的代码中）需要带有原来代码中的协议，商标，专利声明和其他原来作者规定需要包含的说明。</li>
<li>如果再发布的产品中包含一个Notice文件，则在Notice文件中需要带有Apache Licence。你可以在Notice中增加自己的许可，但不可以表现为对Apache Licence构成更改。</li>
</ol>
<p>除了这些条件它还有这些好处：</p>
<ol>
<li>永久权利 一旦被授权，永久拥有。</li>
<li>全球范围的权利 在一个国家获得授权，适用于所有国家。假如你在美国，许可是从印度授权的，也没有问题。</li>
<li>授权免费 无版税， 前期、后期均无任何费用。</li>
<li>授权无排他性 任何人都可以获得授权</li>
<li>授权不可撤消 一旦获得授权，没有任何人可以取消。比如，你基于该产品代码开发了衍生产品，你不用担心会在某一天被禁止使用该代码<br>使用apache Licence vesion 2.0协议的开源软件有：Hadoop 、apache httpserver、Spring Framework、MongoDB 。</li>
</ol>
<h2 id="MIT"><a href="#MIT" class="headerlink" title="MIT"></a><a href="http://en.wikipedia.org/wiki/MIT_License" target="_blank" rel="external">MIT</a></h2><p>MIT，源自麻省理工学院（Massachusetts Institute of Technology, MIT），又称X11协议。MIT与BSD类似，但是比BSD协议更加宽松，是目前最少限制的协议。<br>这个协议唯一的条件就是在修改后的代码或者发行包包含原作者的许可信息。适用商业软件。使用MIT的软件项目有：jquery、Node.js。</p>
<h2 id="MPL"><a href="#MPL" class="headerlink" title="MPL"></a><a href="http://www.mozilla.org/MPL/" target="_blank" rel="external">MPL</a></h2><p>MAL是The Mozilla Public License的简写，是1998年初Netscape的 Mozilla小组为其开源软件项目设计的软件许可证。MPL许可证出现的最重要原因就是，Netscape公司认为GPL许可证没有很好地平衡开发者对源代码的需求和他们利用源代码获得的利益。同著名的GPL许可证和BSD许可证相比，MPL在许多权利与义务的约定方面与它们相同（因为都是符合OSIA 认定的开源软件许可证）。但是，相比而言MPL还有以下几个显著的不同之处:</p>
<ol>
<li>MPL虽然要求对于经MPL许可证发布的源代码的修改也要以MPL许可证的方式再许可出来，以保证其他人可以在MPL的条款下共享源代码。但是，在MPL 许可证中对“发布”的定义是“以源代码方式发布的文件”，这就意味着MPL允许一个企业在自己已有的源代码库上加一个接口，除了接口程序的源代码以MPL 许可证的形式对外许可外，源代码库中的源代码就可以不用MPL许可证的方式强制对外许可。这些，就为借鉴别人的源代码用做自己商业软件开发的行为留了一个豁口。</li>
<li>MPL许可证第三条第7款中允许被许可人将经过MPL许可证获得的源代码同自己其他类型的代码混合得到自己的软件程序。</li>
<li>对软件专利的态度，MPL许可证不像GPL许可证那样明确表示反对软件专利，但是却明确要求源代码的提供者不能提供已经受专利保护的源代码（除非他本人是专利权人，并书面向公众免费许可这些源代码），也不能在将这些源代码以开放源代码许可证形式许可后再去申请与这些源代码有关的专利。</li>
<li>在MPL（1.1版本）许可证中，对源代码的定义是:“源代码指的是对作品进行修改最优先择取的形式，它包括:所有模块的所有源程序，加上有关的接口的定义，加上控制可执行作品的安装和编译的‘原本’（原文为‘Script’），或者不是与初始源代码显著不同的源代码就是被源代码贡献者选择的从公共领域可以得到的程序代码。”</li>
<li>MPL许可证第3条有专门的一款是关于对源代码修改进行描述的规定，就是要求所有再发布者都得有一个专门的文件就对源代码程序修改的时间和修改的方式有描述。</li>
</ol>
<h1 id="开源协议的选择"><a href="#开源协议的选择" class="headerlink" title="开源协议的选择"></a>开源协议的选择</h1><p>关于如何选择开源协议，这里可以参考<a href="http://www.ruanyifeng.com/blog/" target="_blank" rel="external">阮一峰</a>老师的一张图<br><img src="/images/free_software_licenses.png" alt="开源协议选择"></p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
  </section>

  
  <nav class="pagination">
    <span class="page-number current">1</span><a class="page-number" href="/page/2/">2</a><a class="extend next" rel="next" href="/page/2/"><i class="fa fa-angle-right"></i></a>
  </nav>



          </div>
          


          

        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      

      <section class="site-overview sidebar-panel sidebar-panel-active">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
          
            <p class="site-author-name" itemprop="name"></p>
            <p class="site-description motion-element" itemprop="description"></p>
        </div>

        <nav class="site-state motion-element">

          
            <div class="site-state-item site-state-posts">
            
              <a href="/archives/">
            
                <span class="site-state-item-count">18</span>
                <span class="site-state-item-name">日志</span>
              </a>
            </div>
          

          
            
            
            <div class="site-state-item site-state-categories">
              <a href="/categories/index.html">
                <span class="site-state-item-count">5</span>
                <span class="site-state-item-name">分类</span>
              </a>
            </div>
          

          
            
            
            <div class="site-state-item site-state-tags">
              <a href="/tags/index.html">
                <span class="site-state-item-count">19</span>
                <span class="site-state-item-name">标签</span>
              </a>
            </div>
          

        </nav>

        

        <div class="links-of-author motion-element">
          
        </div>

        
        

        
        

        


      </section>

      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright" >
  
  &copy; 
  <span itemprop="copyrightYear">2018</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder"></span>

  
</div>


  <div class="powered-by">由 <a class="theme-link" href="https://hexo.io">Hexo</a> 强力驱动</div>

  <span class="post-meta-divider">|</span>

  <div class="theme-info">主题 &mdash; <a class="theme-link" href="https://github.com/iissnan/hexo-theme-next">NexT.Mist</a> v5.1.2</div>


        







        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  












  
  <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>

  
  <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>

  
  <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.2"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.2"></script>



  
  

  <script type="text/javascript" src="/js/src/scrollspy.js?v=5.1.2"></script>
<script type="text/javascript" src="/js/src/post-details.js?v=5.1.2"></script>


  

  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.2"></script>



  


  




	





  





  








  





  

  

  

  

  

  

</body>
</html>
